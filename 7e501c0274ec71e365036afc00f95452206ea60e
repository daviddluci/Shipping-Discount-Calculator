needs more refactoring to satisfy RuboCop (calculate_discount method has too many lines - split into more chunks)
